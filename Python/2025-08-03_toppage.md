# トップページの実装

## ✅ 行ったこと

- トップページの実装

## 流れ

### ①top.hrtmlを作る
templates/sample_app/top.htmlに以下のようなコードを書く
```
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>My Sample App</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

  <!-- ナビバー -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">My App</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link active" href="#">ホーム</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">ログイン</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">登録</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- メインコンテンツ -->
  <div class="container mt-5 text-center">
    <h1 class="display-4">タスク管理！</h1>
    <p class="lead">タスク管理しましょう</p>
    <a href="#" class="btn btn-primary btn-lg">はじめる</a>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

```

### ②views.py でこのテンプレートを使うビューを作成
sample_app/views.pyに以下の記述を追加
```
from django.shortcuts import render

def top_view(request):
    return render(request, 'sample_app/top.html')

```

実際のコードでは
```
from django.shortcuts import render, get_object_or_404, redirect
from django.forms import ModelForm

from sample_app.models import Post


def top_view(request):
    return render(request, 'sample_app/top.html')

...
```
`from django.shortcuts import render`のコードは、既に`from django.shortcuts import render, get_object_or_404, redirect`が存在するので書かなくてもよかった

### ③urls.py にルーティングを設定する
sample_app/urls.pyにルーティングを追加
```
from django.urls import path
from . import views

app_name = 'sample_app'

urlpatterns = [
    path('', views.top_view, name='top'),
]

```

実際のコード
```
from django.urls import path
from sample_app import views


app_name = 'sample_app'
urlpatterns = [
    path('', views.top_view, name='top'), # トップページ
    path('post/create/', views.create_post, name='create_post'),  # 作成
    path('post/edit/<int:post_id>/', views.edit_post, name='edit_post'),  # 修正
    path('post/', views.read_post, name='read_post'),   # 一覧表示
    path('post/delete/<int:post_id>/', views.delete_post, name='delete_post'),   # 削除
]

```
トップページの部分を追加


### ④プロジェクト側の urls.py にも追加
my_project/urls.py
```
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('sample_app/', include('sample_app.urls')), #トップページ用のルート
    path('admin/', admin.site.urls),
]

```
🔸 my_project/urls.py とは？<br>
→ プロジェクト全体の「入り口」。<br>
「どのURLがどのアプリ・ビューに進むのか？」を最初に判断する場所。

🔸 path('sample_app/', include('sample_app.urls')) の意味<br>
sample_app/ というURLが来たときに、<br>
sample_app.urls ファイルの中身をさらに読み込んで、<br>
その中のルーティング設定に沿って振り分ける。

🔸 include() の役割<br>
include() は、「別ファイルのURL設定を読み込む」というDjangoの仕組み。<br>
なので、アプリごとにurls.pyを分けて管理しやすくするのが目的

## topページからtasklistに飛べるようにする
```
<a href="#" class="btn btn-primary btn-lg">はじめる</a>
```
このボタンで飛べるようにする
```
<a href="{% url 'sample_app:read_post' %}" class="btn btn-primary btn-lg">はじめる</a>
```
このように変更<br>
なぜこれでできるのか？

### 仕組みを分解
1. URLパターンに名前を付ける
sample_app/urls.py にこう書いてある
```
path('post/', views.read_post, name='read_post')
```
ここで name='read_post' が「URLの名前」になる。

2. {% url %} タグが名前からURLを作る
テンプレート内で
```
<a href="{% url 'sample_app:read_post' %}">はじめる</a>
```
と書くと、Djangoは次のように変換する：
```
{% url 'sample_app:read_post' %}  
→ /sample_app/post/
```
つまり、URLのパスを直接書く代わりに、nameを指定するとDjangoが正しいパスを生成してくれる。

3. メリット：URLをハードコーディングしなくていい
もし /sample_app/post/ というURLを直接HTMLに書くと、将来URLを post-list/ に変えたときにHTMLも全部修正しないといけない。<br>
でも、{% url 'sample_app:read_post' %} と書いておけば、 urls.py のパスだけ変更すれば全部自動でリンクが変わる。

4. sample_app: の意味
sample_app: は アプリ名 を表している。<br>
urls.py の最初に
```
app_name = 'sample_app'

```
って書いてあるから、「sample_appアプリのread_postという名前のURL」という意味になる。

